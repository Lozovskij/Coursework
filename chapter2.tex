\chapter{ЦЕНТРАЛИЗОВАННОЕ ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ}\label{chap2}


(Врезка) ...

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Задача оптимального управления группой динамических систем}\label{2_1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Определим $T$ и $T_h$ как в главе 1 : $T = [t_0,\ t_f],\ T_h = \{t_0,~ t_0 - h, \dots ,~ t_f - h\},\ h = \dfrac{t_f - t_0}{N},\ N \in \mathbb{N}$.


Пусть $I = \{1,\ 2,\ ...,\ q\}$, $I_i = I\backslash i$; $A_{ij}(t) \in \R^{n_i \times n_j}, B_{ij}(t) \in \R^{n_i \times r_j}$, $t \in T$, $i, j \in I$, --- кусочно-непрерывные матричные функции; $A_i(t) = A_{ii}(t)$, $B_i(t) = B_{ii}(t)$, $t \in T$, $i \in I$.


Составим задачу оптимального управления для группы $q$ взаимосвязанных линейных нестационарных объектов управления. 


Будем считать \cite{JVM_2008}, что на промежутке $T$ модель $i$-го ($i \in I$) объекта имеет вид:
\begin{equation}\label{equation_mainModel}
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i + 
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0},
\end{equation}
где $x_i = x_i(t) \in \R^{n_i}$ --- состояние $i$-ой математической модели; $u_i = u_i(t) \in U_i = \{u \in \R^{r_i} : u_{i*} \leq u \leq u_i^* \}$ --- дискретное управляющие воздействие $i$-ой математической модели c периодом квантования $h$ ($u_{i*}, u_i^* \in \R^{r_i}$ --- заданные векторы). Будем также считать, что $x = (x_1' , . . . , x_q' )', u = (u_1' , . . . , u_q' )', \ n = \sum_{i \in I_i} n_i, \ r = \sum_{i \in I_i} r_i.$ Таким образом $u \in \R^{r}$, $x \in \R^{n}$.


Функции $A_{ij}(t), t \in T, i \in I_j$, служат для описания влияния на $i$-ую модель остальных моделей, а функции $B_{ij}(t), t \in T, i \in I_j$, --- для описания влияния на на $i$-ую модель управляющих воздействий остальных моделей. Функция $A_i(t), t \in T,$ характеризует собственную динамику $i$-й модели, а $B_i(t), t \in T,$ определяет её входное устройство.


Определим терминальное множество $S$:
\begin{equation}\label{main_terminal_limits}
x(t_f) \in S = \left\lbrace(x_1' , . . . , x_q' )': \sum_{i \in I} H_i x_i =g\right\rbrace,
\end{equation}
где $H_i \in \R^{m \times n_i}$, rank$(H_i) = m \le n_i, i \in I, g \in \R^m.$ В дальнейшем пусть $H = (H_1, ..., H_q).$ То есть (\ref{main_terminal_limits}) можно записать в виде:


\begin{equation}\label{main_terminal_limits_simplified}
x(t_f) \in S = \left\lbrace x: H x = g\right\rbrace,
\end{equation}


Целью управления является минимизация линейного терминального критерия качества:
\begin{equation}\label{main_quolity}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
где $c_i \in \R^{n_i}$ --- заданные векторы. Пусть $c = (c_1' , . . . , c_q' )'$, тогда (\ref{main_quolity}) можно записать в виде:


\begin{equation}\label{main_quolity_simplified}
c' x \to \min_{u}.
\end{equation}


Таким образом задача оптимального управления для группы $q$ взаимосвязанных линейных нестационарных объектов управления имеет вид:
\begin{equation}\label{main_task}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
\[
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i + 
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0},
\]
\[ \sum_{i \in I} H_i x_i(t_f) = g, \quad u_i = u_i(t) \in U_i, \quad i \in I.\]


Группой динамических объектов (\ref{equation_mainModel}) можно управлять централизованно и децентрализованно \cite{JVM_2016}. 


В централизованном случае имеется общий центр управления, которой на каждом промежутке времени $[ \tau, \tau + h[, \tau \in T_h$ по точной информации о состоянии $x^*(\tau) = (x_i^*(\tau), i \in I)$ группы вырабатывает управляющие воздействия $u^*(t) = (u_i^*(t), i \in I), t \in [\tau, \tau + h[, \tau \in T_h$, которое используется до тех пор, пока не будет измерено и обработано следующее состояние $x^*(\tau + h)$ . 


В децентрализованном случае для каждого $i$-го объекта по точному состоянию $x_i^*(\tau), \tau \in T_h$ и состояниям $x_j^*(\tau - h), \tau \in T_h, j \in I_i,$ строится локальное управляющее воздействие $u_i^*(t), t \in [\tau, \tau + h[, \tau \in T_h$, которое используется до тех пор, пока не будет измерено и обработано следующее состояние $x_i^*(\tau + h)$.


При централизованном управлении динамическая модель (\ref{equation_mainModel}) рассматривается как одна большая система:
\begin{equation}\label{equation_BigSystem}
\dot x = A(t) x + B(t) u, \quad x(t_0) = x_0,
\end{equation}
где $x = (x_1' , . . . , x_q' )', u = (u_1' , . . . , u_q' )', x_0 = (x_{1,0}', ... ,x_{q,0}')'$; $A,\ B$ --- соответствующие блочные матрицы.


Система (\ref{equation_BigSystem}) имеет единственный регулятор, который в режиме реального времени на основе измеренного точного текущего состояния $x^*(\tau) \in \R^{n}$ вырабатывает управляющий сигнал $u^*(\tau) \in \R^{r}$. Для этого оптимальный регулятор для каждого момента $\tau \in T_h$ решает (\cite{JVM_2016}, с. 1713) задачу $P(\tau)$:
\[c' x(t_f) \to \min_{u},\] 
\[\dot x = A(t) x + B(t) u,\]
\[x(\tau) = x^*(\tau),\]
\[H x(t_f) = g, \quad  u \in U,\quad t \in [\tau, t_f],\]
где $c = (c_1' , . . . , c_q' )'$; $U = U_1 \times U_2 \times ... \times U_q$.


%После сведения исходной задачи к задаче линейного программирования, получим:
%\[c' x(t_N, v) \to \min_{v},\]
%\[x(t_0, v) = x_{0},\] 
%\[x(t_N, v) \in X_f,\] 
%\[ 
%v_i \in U, \ i = 0,1,\ldots, N-1,
%\]
%где $v = (v_0, ..., v_{N - 1})$ --- характеризующий $u$ вектор параметров, $x(t, v)$ --- зависящая от $v$ итоговая траектория.
%(я не понял, что надо сделать и еще кое-что...)
 
Сведем (\ref{main_task}) к задаче линейного программирования, используя последовательный и параллельный подходы. 


Рассмотрим параллельный подход. Для этого запишем формулу Коши для системы в непрерывном времени:


\begin{equation} \label{formula_Cauchy}
x(t) = F(t,t_0)x_0 + \int\limits_{t_0}^t F(t,\theta)B(\theta)u(\theta)\,d\theta.
\end{equation}


Пусть $t_0 = s, s \in T_h$. Применим данную формулу для дискретного управления и подставим $t = s + h$:
\[
	x(s + h) = A_h(s)x(s) + B_h(s)u(s),
\]
где $A_h(s) = F(s+h,s), \ B_h(s) = \int\limits_{s}^{s+h} F(s+h,\theta)B(\theta)\,d\theta.$


В итоге задача (\ref{main_task}) примет вид:
\[c' x(t_f) \to \min_{u},\]
\[x(s + h) = A_h(s)x(s) + B_h(s)u(s), \ s \in T_h,\]
\[x(t_0) = x_0,\]
\[H x(t_f) = g,\] 
где неизвестными являются $x(s), \ s \in T_h \cup t_f$ и $u(s), \ s \in T_h$.


Таким образом при использовании параллельного подхода имеем всего 
%$(N + 1) n + N r$ неизвестных.
$N n + m$ огрничение.


Рассмотрим последовательный подход. Подставим в формулу Коши (\ref{formula_Cauchy}) $t = t_f$, а получившуюся величину $x(t_f)$ подставим в исходную задачу (\ref{main_task}). Тогда (\ref{main_task}) имеет вид:
\begin{equation}
\sum_{s \in T_h} c_h(s) u(s) \to \min,
\end{equation}
\[\sum_{s \in T_h} d_h(s) u(s) = \tilde g,\]
\[u_* \le u(s) \le u^*,  \ s \in T_h\,\]
где $c_h(s) = \int\limits_{s}^{s+h} c' F(t_f,\theta)B(\theta)\,d\theta$, $c_h(s) \in \R^{r}$, $d_h(s) = \int\limits_{s}^{s+h} H F(t_f,\theta)B(\theta)\,d\theta$, $d_h(s) \in \R^{m \times r}$; $\tilde g = g - H F(t_f, t_0)x_0.$


Таким образом при использовании последовательного подхода имеем всего $N m$ огрничений.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Построение централизованной обратной связи в реальном времени}\label{2_2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

.....

\bigskip

Не забываем делать выводы.