\documentclass[notheorems]{beamer}
\usepackage[cp1251]{inputenc}
\usepackage{SlideStyle}


\titlegraphic{\vspace*{-7cm}
    \parbox[c]{3cm}{\includegraphics[height=.7cm]{bsulogo}}
    \hspace*{1cm}%
    \parbox[c]{2cm}{\includegraphics[height=1.5cm]{FPMIlogo}}
    \hspace*{1cm}%
    \parbox[c]{3cm}{\includegraphics[height=.7cm]{MOUlogo}}
    \vspace*{3cm}
}

\title[Децентрализованное оптимальное управление]{\Large ДЕЦЕНТРАЛИЗОВАННОЕ ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ}


\author[И.И. Лозовский]{Иван И. Лозовский}


\institute[ФПМИ, БГУ]{}


\date[\copyright 2019-2020]{}%{\scriptsize \structure{2017-2018}}


\begin{document}


\maketitle


%--------------------------------------------------------------------------------------
\begin{frame}{Группа объектов управления}
\begin{itemize}
\item Группа из $q$ взаимосвязанных линейных нестационарных объектов управления
\item \structure{Математическая модель $i$-го объекта}, $i \in I = \{1,\ 2,\ ...,\ q\}$
$$
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0}
$$
	\begin{itemize}
	\item$T = [t_0,\ t_f]$
	\item$x_i = x_i(t) \in \R^{n_i}, \ t \in T$
	\item$u_i = u_i(t) \in U_i = \{u \in \R^{r_i} : u_{i*} \leq u \leq u_i^* \}, \ t \in T$
	\item$A_i(t), t \in T$, $B_i(t), t \in T,$ --динамика и входное устройство $i$-й модели
	\end{itemize}
\item $T_h = \{t_0,~ t_0 - h, \dots ,~ t_f - h\},\ h = \dfrac{t_f - t_0}{N},\ N \in \mathbb{N}$

\item \structure{Дискретное управляющее воздействие} 
$$u(t) \equiv u(\tau), ~~~t \in [\tau, ~\tau + h[,~~~ \tau \in T_h$$

\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Статические взаимосвязи}
\begin{itemize}
	\item \structure {Терминальное множество $S$ } (общее для всех объектов)
	$$x(t_f) \in S = \left\lbrace
\begin{pmatrix}
	x_1\\
	\vdots\\
	x_q\\
\end{pmatrix} \in \R^n : \sum_{i \in I} H_i x_i =g\right\rbrace$$
	\begin{itemize}
	\item $n = \sum_{i \in I_i} n_i$ \bigskip
	\item $H_i \in \R^{m \times n_i}$ \bigskip
	\item rank$(H_i) = m \le n_i, i \in I$ \bigskip
	\item $g \in \R^m$
	\end{itemize}
	
\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Статические взаимосвязи}
$$x(t_f) \in S = \left\lbrace
\begin{pmatrix}
	x_1\\
	\vdots\\
	x_q\\
\end{pmatrix} \in \R^n : \sum_{i \in I} H_i x_i =g\right\rbrace$$
\begin{itemize}
	\item Упрощенная запись
	$$ x(t_f) \in S = \left\lbrace x: H x = g\right\rbrace $$
	\begin{itemize}	
	\item $\ x = \begin{pmatrix}x_1\\ \vdots \\ x_q\\
\end{pmatrix}$ \bigskip
	\item $H = (H_1, ..., H_q)$
	\end{itemize}
\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Цель управления}
\begin{itemize}
	\item Минимизация \structure {линейного терминального} критерия качества
 $$\sum_{i \in I} c_i' x_i(t_f) \to \min_{u}$$

	\item Упрощенная запись
	$$c' x \to \min_{u}, \ c = \begin{pmatrix}
	c_1\\
	\vdots\\
	c_q\\
\end{pmatrix}$$


\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Задача оптимального управления \\ для группы}
\begin{block}{}
$$\sum_{i \in I} c_i' x_i(t_f) \to \min_{u}$$
$$\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0}, \ i\in I$$
$$\sum_{i \in I} H_i x_i(t_f) = g$$
\end{block}
\begin{itemize}	
\item $u_i(t) \in U_i, \quad t\in T, \quad i \in I$
\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Централизованное и  \\ децентрализованное управление}
\begin{columns}
    \begin{column}{5.5cm} 
	\begin{block}{Централизованное}
	\begin{figure}[h!]
  	\centering
  	\includegraphics[width=1\textwidth]{CentrControlScheme.eps}\\
	\end{figure}
	\structure {центральный регулятор вычисляет значение управления для всех объектов группы}
	\end{block}
	\end{column}

	\begin{column}{5.5cm} 
	\begin{block}{Децентрализованное}
	\begin{figure}[h!]
  	\centering
  	\includegraphics[width=1\textwidth]{DecControlScheme.eps}\\
	\end{figure}
	\structure {локальный регулятор строит локальное управление}
	\end{block}
	\end{column}
\end{columns}
\end{frame}%--------------------------------------------------------------------------------------
\begin{frame}{Построение централизованной обратной \\ связи в реальном времени}
\begin{itemize}
\item Упрощенный вид решаемой задачи
$$\dot x = A(t) x + B(t) u, \quad x(t_0) = x_0$$

	\begin{itemize}
	\item $x =
\begin{pmatrix}
	x_1\\
	\vdots\\
	x_q\\
\end{pmatrix},
u =
\begin{pmatrix}
	u_1\\
	\vdots\\
	u_q\\
\end{pmatrix},
x_0 =
\begin{pmatrix}
	x_{1,0}\\
	\vdots\\
	x_{q,0}\\
\end{pmatrix}$ 
	\item $A,\ B$ --- соответствующие блочные матрицы
	\end{itemize}


\item Построение реализации обратной связи
$$
    x^*(\tau) =
\begin{pmatrix}
	x_1^*(\tau)\\
	\vdots\\
	x_q^*(\tau)\\
\end{pmatrix}, \ \tau \in T_h, \ 
	u^*(t) =
\begin{pmatrix}
	u_1^*(t)\\
	\vdots\\
	u_q^*(t)\\
\end{pmatrix}, \ \
t \in [\tau, \tau + h[,
$$

\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Задача $P(\tau)$}

Для построения реализации обратной связи оптимальный регулятор решает задачу $P(\tau)$:
\begin{columns}
\begin{column}{8cm}
\begin{block}{}
\[c' x(t_f) \to \min_{u},\]
\[\dot x = A(t) x + B(t) u, \quad x(\tau) = x^*(\tau),\]
\[H x(t_f) = g, \quad u \in U,\quad t \in [\tau, t_f] \]
\end{block}
\end{column}
\end{columns}

\begin{itemize}
	\item $U = U_1 \times U_2 \times ... \times U_q$
	\item Оптимальную программу задачи $P(\tau)$ будем обозначать $u^0(t|\tau,x^*(\tau)), t \in [\tau, t_f]$
\end{itemize}

\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Алгоритм построения реализации \\ 
централизованной обратной связи  
$u^*(\tau, x^*(\tau))$, $\tau \in T_h$}
\begin{enumerate}
\item Положить $\tau = t_0, \ x^*(\tau) = x_0$.


\item Найти оптимальную программу $u^0(t|\tau,x^*(\tau)), t \in [\tau, t_f]$, задачи $P(\tau)$.

\item  Задать значение оптимальной обратной связи для позиции $(\tau,x^*(\tau))$:
\[
u^0(\tau, x^*(\tau)) = u^0(\tau|\tau,x^*(\tau)),
\]
и подать на объект управления управляющее воздействие 
\[
    u^*(t) \equiv u^*(\tau) := u^0(\tau, x^*(\tau)), \  \ t\in [\tau, \tau+h[.
\]

\item В момент $\tau + h$ измерить  $x^*(\tau + h)$, положить $\tau:= \tau+ h$, при $\tau < t_f$ вернуться к шагу 2.
\end{enumerate}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Последовательный подход}

\begin{itemize}
\item Формула Коши
$$x(t) = F(t,t_0)x_0 + \int\limits_{t_0}^t F(t,\theta)B(\theta)u(\theta)\,d\theta$$
\item Подставим в формулу Коши $t = t_f$, а получившуюся величину $x(t_f)$ подставим в исходную задачу

\begin{columns}
	\begin{column}{0.5cm} \end{column}
    \begin{column}{4.5cm} 
	\begin{block}{}
	$$\sum_{s \in T_h} c_h'(s) u(s) \to \min,$$
$$\sum_{s \in T_h} D_h(s) u(s) = \tilde g,$$
$$u_* \le u(s) \le u^*,  \ s \in T_h $$
	\end{block}
	\end{column}
	\begin{column}{6cm}
	\begin{itemize}
	\item $c_h'(s) = \int\limits_{s}^{s+h} c' F(t_f,\theta)B(\theta)\,d\theta,$
	\item $c_h(s) \in \R^{r}$
	\item $D_h(s) = \int\limits_{s}^{s+h} H F(t_f,\theta)B(\theta)\,d\theta,$
	\item $D_h(s) \in \R^{m \times r},$
	\item $\tilde g = g - H F(t_f, t_0)x_0$
	\end{itemize}
	\end{column}
\end{columns}
\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Функциональная форма $P(\tau)$}

\begin{columns}
\begin{column}{8cm}
\begin{block}{}
$$\sum_{s \in T_h(\tau)} c_h'(s) u(s) \to \min,$$
$$\sum_{s \in T_h(\tau)} D_h(s) u(s) = \tilde g(\tau),$$
$$u_* \le u(s) \le u^*,  \ s \in T_h(\tau)$$
\end{block}
\end{column}
\end{columns}\bigskip

\begin{itemize}
\item $T_h(\tau) = [\tau, t_f] \cap T_h$\bigskip
\item $\tilde g = g - H F(t_f, \tau) x^*(\tau)$\bigskip
\end{itemize}

\end{frame}%--------------------------------------------------------------------------------------
\begin{frame}{Рассматриваемый пример}
\begin{itemize}

\item Три взаимосвязанных системы
\begin{align}
\ddot{z_1} &= -2kz_1 + kz_2 + u_1 + w_1,\notag \\
\ddot{z_2} &= -2kz_2 + kz_1 + kz_3 + u_2 + w_2,\notag\\ 
\ddot{z_3} &= -2kz_3 + kz_2 + u_3 + w_3 \notag
\end{align}
	\begin{itemize}
	\item $ |u_i(t)| \le L, \ i \in I = \{1, \ 2, \ 3\}$\bigskip
	\item $ t\in [t_0,t_f]$
	\end{itemize}

\item Ограничения, задающие терминальное множество
\[
	|z_i(t_f)| \le d_1, \ |\dot{z_i}(t_f)| \le d_2, i \in I
\]

\item Критерий качества
\[
	\int\limits_{t_0}^{t_f} \sum_{i \in I} |u_i(t)|\,dt \to \min.
\]

\end{itemize}
\end{frame}%--------------------------------------------------------------------------------------
\begin{frame}{Параметры задачи и замена}
\begin{itemize}

\item Параметры задачи 
\[
	k = 10,\ L = 1,\ t_0 = 0,\ t_f = 4.5
\] 
\[
	d_i = 0.1,\ \dot{z_i}(0) = 1,\ z_i(0) = 1,\ i \in I
\]
$$N = 100 => h = \dfrac{1}{N} = \dfrac{1}{100}$$ 
\[
w(t) = 
\begin{pmatrix}
	0.7\,\sin 2t\\
	0.1\,\cos t\\
	-0.05\,\cos 3t\\
\end{pmatrix}
\]

\item Замена
\begin{align}
x_1 &= z_1, \qquad x_3 = z_2, \qquad x_5 = z_3, \notag \\
x_2 &= \dot{z_1}, \qquad x_4 = \dot{z_2}, \qquad x_6 = \dot{z_3}.\notag
\end{align}
\end{itemize}
\end{frame}%--------------------------------------------------------------------------------------
\begin{frame}{Вид задачи после замены}
%\begin{itemize}
%\item Доплнительные переменные
%	\begin{itemize}
%	\item $n = 6$ -- число равенств замены
%	\item $q = 3$ -- число взаимосвязанных систем
%	\item $r = q$ -- число управлений
%	\item $m = 2n$ -- число ограничений на $x_i, \ i = 1...n$
%	\end{itemize} 
%\end{itemize} 
 
 \begin{columns}
\begin{column}{6cm}
\begin{block}{}
$$\int\limits_{t_0}^{t_f} \sum_{i \in I} |u_i(t)|\,dt \to \min,$$

\[
	\dot{x}(t) = Ax(t) + Bu(t) + Mw(t),
\]
\[
	x(0) = x_0, \ t \in [t_0, t_f], \ Hx(t_f) \le g
\]
\end{block}
\end{column}
\begin{column}{4cm}
\[
H = \begin{pmatrix}
	E_6 \\
	-E_6\\
	\end{pmatrix},
\]\bigskip
\[
	g = 0.1 \cdot \mathbbm{1}_{12},
\]
\end{column}
\end{columns}

\[
	A = \begin{pmatrix}
	0 & 1 & 0 & 0 & 0 & 0 \\
	-2k & 0 & k & 0 & 0 & 0 \\
	0 & 0 & 0 & 1 & 0 & 0 \\
	k & 0 & -2k & 0 & k & 0 \\
	0 & 0 & 0 & 0 & 0 & 1 \\
	0 & 0 & k & 0 & -2k & 0 \\
	\end{pmatrix}, \ 	
	B = M = \begin{pmatrix}
	0 & 0 & 0 \\
	1 & 0 & 0 \\
	0 & 0 & 0 \\
	0 & 1 & 0 \\
	0 & 0 & 0 \\
	0 & 0 & 1 \\
	\end{pmatrix}, \ 	
	x_0 = \begin{pmatrix}
	1\\ 1\\ 1\\ 1\\ 1\\ 1\\
	\end{pmatrix}
\]

\end{frame}%--------------------------------------------------------------------------------------
\begin{frame}{Функциональная форма данного\\ примера}
\begin{itemize}
\item Замена
$$u(s) = z(s) - v(s), s \in T_h$$
\item После применения последовательного подхода получим
\begin{columns}
\begin{column}{6cm}
\begin{block}{}
$$\sum_{s \in T_h} 
	c'
	\begin{pmatrix} z(s) \\ v(s) \\ \end{pmatrix} \to \min,$$
$$\sum_{s \in T_h} 
	(D_h(s), -D_h(s))
	\begin{pmatrix} z(s) \\ v(s) \\ \end{pmatrix}  \le \tilde g$$
\end{block}
\end{column}
\end{columns}

\item $D_h(s)$ и $\tilde g$ задаются аналогично тому, как задавались при сведении задачи к задаче ЛП

\end{itemize}
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Функциональная форма данного\\ примера}
\begin{columns}
\begin{column}{6cm}
\begin{block}{}
$$\sum_{s \in T_h} 
	c'
	\begin{pmatrix} z(s) \\ v(s) \\ \end{pmatrix} \to \min,$$
$$\sum_{s \in T_h} 
	(D_h(s), -D_h(s))
	\begin{pmatrix} z(s) \\ v(s) \\ \end{pmatrix}  \le \tilde g,$$
$$c = \mathbbm{1}_{2r}$$
\end{block}
\end{column}
\begin{column}{6cm}

	$\quad$Доплнительные переменные
	\begin{itemize}
	\item $n = 6$ -- число равенств замены
	\item $q = 3$ -- число систем
	\item $r = q$ -- число управлений
	\item $m = 2n$ -- число ограничений на $x_i, \ i = 1...n$
	\end{itemize} 

\end{column}
\end{columns}

$$
D_h(s) = \int\limits_{s}^{s+h} H F(t_f,\theta)B(\theta)\,d\theta,\  D_h(s) \in \R^{m \times r};
$$

$$
\tilde g = g - H F(t_f, t_0)x_0 ,\  \tilde g \in  \R^{m}
$$
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}{Результаты. Терминальные состояния}
\begin{figure}[h!]
    \centering
    \scalebox{.5}{\includegraphics{x}}
    %\caption{Фазовые графики}
\end{figure}

$$ X_1 = \begin{pmatrix} -0.0155\\ 0.0978\\ -0.1000\\ 0.0990\\-0.0038\\ 0.0238 \\ \end{pmatrix}, \quad X_2 = \begin{pmatrix} 0.1238\\-0.1174\\ 0.0748\\ -0.0818\\0.1240\\
-0.0233\\  \end{pmatrix}$$
\end{frame}%--------------------------------------------------------------------------------------
\begin{frame}{Сопутствующие результаты}
\begin{itemize}

\item Значение критерия качества для программного решения: $285.0503$.

\item Значение критерия качества для оптимальной обратной связи: $217.5017$

\item Среднее время выполнения функции $P(\tau)$ : $0.029$ секунды

\item Соответствующие фазовым графикам управления
\begin{figure}[h!]
    \centering
    \scalebox{.5}{\includegraphics{u}}
\end{figure}

\end{itemize} 
\end{frame}
%--------------------------------------------------------------------------------------
\begin{frame}
	\centering \Huge\emph{Спасибо за внимание!}
\end{frame}


%--------------------------------------------------------------------------------------
\end{document} 